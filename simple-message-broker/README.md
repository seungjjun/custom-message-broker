# Simple Persistent Message Broker

이 프로젝트의 목표는 "메시지를 받고, 저장하고, 순서대로 전달하는" 과정을 직접 만들어보는 것이다.  

특히 메시지를 **어떻게 파일 시스템에 저장하고 읽는지**에 초점을 맞춰 이에 대한 이해를 높이는 것에 중점을 두고 있다.

## 핵심 개념
- 로그 (Append-Only Log): 메시지를 파일의 끝에 순서대로만 덧붙여 쓰는 방식 구현
- 파일 시스템 기반 저장: 운영체제의 파일 시스템을 직접 사용하여 메시지 데이터를 저장하고 관리
- 영속성 (Persistence): 프로그램이 종료되어도 메시지 데이터가 유지되도록 디스크에 저장
- 순차 읽기/쓰기 (Sequential I/O): 디스크의 순차적인 데이터 접근 성능 활용
- 간단한 네트워킹: 생산자(Producer)와 소비자(Consumer)가 브로커와 TCP 통신을 통해 메시지를 주고받음
- 오프셋 (Offset): 각 메시지의 고유한 순서 번호 또는 파일 내 위치를 사용하여 소비자가 어디까지 읽었는지 추적

## 프로젝트 구성 요소
### 1. Broker (자바 서버 애플리케이션)
- 특정 포트에서 네트워크 연결을 기다린다.
- 연결이 들어오면 새로운 스레드나 비동기 I/O를 사용하여 클라이언트 요청을 처리한다.
- 메시지 저장
  - 생산자로부터 메시지를 받으면, 로그 파일(message.log)의 가장 끝에 덧붙여 쓴다. (java.io.RandomAccessFile 또는 java.nio.channels.FileChannel 활용)
  - 각 메시지를 쓸 때, 메시지 내용 앞에 메시지 길이 같은 간단한 헤더를 붙여서 나중에 읽을 때 메시지 구분을 쉽게 만든다.
- 메시지 전달
  - 소비자로부터 "몇 번 오프셋부터 몇 개의 메시지를 달라"는 요청을 받는다.
  - messages.log 파일을 열어서 요청받은 오프셋 위치부터 순서대로 메시지를 읽어온다 (RandomAccessFile.seek() 또는 FileChannel.position() 활용).
  - 읽어온 메시지들을 소비자에게 네트워크를 통해 전송한다.
- 오프셋 관리: 브로커는 파일의 현재 크기 (=다음 메시지가 저장될 오프셋)를 기억하고 있어야 한다.

### 2. Producer (자바 클라이언트 애플리케이션)
- 브로커의 주소와 포트로 TCP 연결을 맺는다. (Socket)
- 사용자 입력이나 생성된 메시지를 브로커에게 전송한다. (간단한 프로토콜 정의 필요: 예: SEND 메시지내용)

### 3. Consumer (자바 클라이언트 애플리케이션)
- 브로커의 주소와 포트로 TCP 연결을 맺는다. (Socket)
- 자신이 마지막으로 읽었던 오프셋을 기억하고 있는다. (이 오프셋은 소비자가 로컬 파일이나 메모리에 저장)
- 브로커에게 "내 오프셋 다음부터 메시지를 달라"고 요청한다 (간단한 프로토콜 정의 필요)
- 브로커로부터 받은 메시지들을 처리하고, 마지막으로 읽은 오프셋을 업데이트한다.
